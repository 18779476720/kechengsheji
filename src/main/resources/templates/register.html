<!DOCTYPE html>
<html>
<head>
<title>User</title>
	<script type="text/javascript" src="../../static/js/jquery.min.js"></script>
	<script type="text/javascript" src="../../static/js/public.js"></script>
	<script type="text/javascript" src="../../static/js/checkbox.js"></script>
	<script type="text/javascript" src="../../static/page1.js"></script>
	<script type="text/javascript" src="../../static/js/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="../../static/js/jquery.SuperSlide.js"></script>
	<script type="text/javascript" src="../../static/js/bootstrap-3.3.7-dist/bootstrapValidator.js"></script>
	<script type="text/javascript" src="../../static/js/jquery-form-v3.51.0.min.js"></script>
	<script type="text/javascript" src="../../static/js/bootstrap-datetimepicker.min.js"></script>
	<script type="text/javascript" src="../../static/js/locales/bootstrap-datetimepicker.fr.js" charset="UTF-8"></script>
	<script type="text/javascript" src="../../static/js/toastr.min.js"></script>
	<link href="../../static/css/jqueryui.css" rel="stylesheet" type="text/css" />
	<link href="../../static/css/vjpublic.css" rel="stylesheet" type="text/css" />
	<link href="../../static/css/vjpage.css" rel="stylesheet" type="text/css" />
	<link href="../../static/css/config.css" rel="stylesheet" type="text/css" />
	<link href="../../static/js/bootstrap-3.3.7-dist/css/bootstrap.css" rel="stylesheet" type="text/css" />
	<link href="../../static/css/bootstrap.min.css" rel="stylesheet" media="screen">
	<link href="../../static/css/bootstrap-datetimepicker.min.css" rel="stylesheet" type="text/css" />
	<link href="../../static/css/toastr.css" rel="stylesheet" type="text/css"/>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>

<body  class="body_style1" style="background-image: url(../../static/images/jloginbg04.jpg)">
	<div class="container" style="margin-top: 20px">
		<div class="modal-dialog" style="min-width:60%">
			<div class="modal-content">
				<div class="modal-body">
					<form class="form-horizontal" role="form" action="user/register"
						method="post" id="myForm">
						<div class="form-group">
							<label for="accountname" class="col-sm-3 control-label"><i class="text-red" style="color: red">*&nbsp;</i>用户名：</label>
							<div class="col-sm-6">
								<input type="text" class="form-control input-lg" name="accountname" id="accountname"
									placeholder="请输入用户名">
							</div>
						</div>
						<div class="form-group">
							<label for="password" class="col-sm-3 control-label"><i class="text-red" style="color: red">*&nbsp;</i>密码：</label>
							<div class="col-sm-6">
								<input type="password" class="form-control" name="password"
									id="password" placeholder="请输入密码">
							</div>
						</div>
						<div class="form-group">
							<label for="password" class="col-sm-3 control-label"><i class="text-red" style="color: red">*&nbsp;</i>确认密码：</label>
							<div class="col-sm-6">
								<input type="password" class="form-control" name="conpassword"
									id="conpassword" placeholder="请输入确认密码">
							</div>
						</div>
						<div class="form-group">
							<label for="sex" class="col-sm-3 control-label">性别：</label>
							<div class="col-sm-6">
								<input type="radio" name="sex" value = "2" id="sex" checked>
								女
								<input type="radio" name="sex" id="sex" value = "1">
								男
							</div>
						</div>
						<div class="form-group">
							<label for="phone" class="col-sm-3 control-label"><i class="text-red" style="color: red">*&nbsp;</i>phone：</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" name="phone" id="phone"
									placeholder="请输入phone">
							</div>
						</div>
						<div class="form-group">
							<label for="email" class="col-sm-3 control-label"><i class="text-red" style="color: red">*&nbsp;</i>email：</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" name="email" id="email"
									placeholder="请输入email">
							</div>
						</div>
						<div class="form-group">
							<label for="hopeJob" class="col-sm-3 control-label"><i class="text-red" style="color: red">*&nbsp;</i>期望工作类型：</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" name="hopeJob" id="hopeJob"
									   placeholder="请输入期望工作类型">
							</div>
						</div>
						<div class="form-group">
							<label for="email" class="col-sm-3 control-label"><i class="text-red" style="color: red">*&nbsp;</i>姓名：</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" name="studentName" id="studentName"
									   placeholder="请输入姓名">
							</div>
						</div>
						<div class="form-group">
							<label for="datetimepicker" class="col-sm-3 control-label"><i class="text-red" style="color: red">*&nbsp;</i>入学时间：</label>
							<div class="col-sm-6 input-append date form_date" data-date="" data-date-format="yyyy-mm-dd" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
								<input size="16" type="text" value="" id = "enrollmentYear" readonly>
								<span class="add-on"><i class="icon-remove"></i></span>
								<span class="add-on"><i class="icon-th"></i></span>
							</div>
						</div>
						<div class="form-group">
							<label for="datetimepicker" class="col-sm-3 control-label">出生年月：</label>
								<div class="col-sm-6 input-append date form_date" data-date="" data-date-format="yyyy-mm-dd" data-link-field="dtp_input2" data-link-format="yyyy-mm-dd">
									<input size="16" type="text" value="" id = "dateTime" readonly>
									<span class="add-on"><i class="icon-remove"></i></span>
									<span class="add-on"><i class="icon-th"></i></span>
								</div>
						</div>
						<div class="form-group">
							<label for="schoolName" class="col-sm-3 control-label"><i class="text-red" style="color: red">*&nbsp;</i>学校名称：</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" name="schoolName" id="schoolName"
									   placeholder="请输入学校名称">
							</div>
						</div>
						<div class="form-group">
							<label for="schoolAddress" class="col-sm-3 control-label">学校地址：</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" name="schoolAddress" id="schoolAddress"
									   placeholder="请输入学校地址">
							</div>
						</div>
						<div class="form-group">
							<label for="majorName" class="col-sm-3 control-label">专业名称：</label>
							<div class="col-sm-6">
								<input type="text" class="form-control" name="majorName" id="majorName"
									   placeholder="请输入专业名称">
							</div>
						</div>

					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" onclick="cancle()">取消</button>
					<button type="button" class="btn btn-primary" onclick="save()">注册</button>
				</div>
			</div>
		</div>

	</div>
</body>

<script type="text/javascript">
    $('.form_date').datetimepicker({
        language:  'fr',
        weekStart: 1,
        todayBtn:  1,
        autoclose: 1,
        todayHighlight: 1,
        startView: 2,
        minView: 2,
        forceParse: 0
    });
    $('#datetimepicker').datetimepicker();
	function cancle() {
        window.location.href = "/welcome";
	}
	function save() {
	    var accountname = $("#accountname").val();
	    var conpassword = $("#conpassword").val();
	    var password = $("#password").val();
	    var sex = $("#sex").val();
	    var phone = $("#phone").val();
        var email = $("#email").val();
        var studentName = $("#studentName").val();
        var enrollmentYear = $("#enrollmentYear").val();
        var dateTime = $("#dateTime").val();
        var schoolName = $("#schoolName").val();
        var schoolAddress = $("#schoolAddress").val();
        var majorName = $("#majorName").val();
        var hopeJob = $("#hopeJob").val();
        if(accountname == "" || accountname == undefined){
            toastr.error('用户名不能为空');
            return false;
		}else if(password == "" || password == undefined){
            toastr.error('密码不能为空');
            return false;
		}else if(conpassword == "" || conpassword == undefined){
            toastr.error('确认密码不能为空');
            return false;
		}else if(password != "" && conpassword != ""){
            if(password != conpassword){
                toastr.error('密码和确认密码不一致');
                return false;
			}
		}else if(phone == "" || phone == undefined){
            toastr.error('phone不能为空');
            return false;
        }
        else if(email == "" || email == undefined){
            toastr.error('email不能为空');
            return false;
        }else if(hopeJob == "" || hopeJob == undefined){
            toastr.error('期望工作类型不能为空');
            return false;
        } else if(studentName == "" || studentName == undefined){
            toastr.error('学生姓名不能为空');
            return false;
        }else if(enrollmentYear == "" || enrollmentYear == undefined){
            toastr.error('入学时间不能为空');
            return false;
        }else if(schoolName == "" || schoolName == undefined){
            toastr.error('学校名称不能为空');
            return false;
        }
        //学校信息
        var school = {
            schoolCode: null,
            schoolName: schoolName,
			schoolAddress:schoolAddress
		}
		var schoolInfo = JSON.stringify(school);

        var role = '';
        debugger
        var myurl=GetQueryString("html_url");
        if(myurl !=null && myurl.toString().length>1){
            role = GetQueryString("registerType");
        }

        //学生信息
        var student = {
            phone: phone,
            email: email,
			hopeJob: hopeJob,
            majorName: majorName,
            sex: sex,
            studentName: studentName,
            enrollmentYear: enrollmentYear,
            dateTime: dateTime
        }
        var studentInfo = JSON.stringify(student);

        var params = {
            id: null,
            accountname: accountname,
            password: password,
            role: role,
			createdBy: null,
			createDate:null,
			lastUpdateBy: null,
			lastUpdateDate:null,
            studentInfo: studentInfo,
            schoolInfo:schoolInfo
		}

        $.ajax({
            type: "POST",
            contentType: 'application/json',
            dataType: "json",
            url: "http://localhost:8088/account/registerIn",
			data: JSON.stringify(params),
            success: function (data){
                debugger
                if(data.code != "000001" ){
                    toastr.error(data.message);
                    return false;
                }
                toastr.success("注册成功,界面即将跳转！");
                setTimeout(function () {
                    window.location.href = "/welcome";
				}, 3000);

            },
        });
        //获取url参数
        function GetQueryString(name)
        {
            var reg = new RegExp("(^|&)"+ name +"=([^&]*)(&|$)");
            var r = window.location.search.substr(1).match(reg);//search,查询？后面的参数，并匹配正则
            if(r!=null)return  unescape(r[2]); return null;
        }

	}
</script>
</html>

