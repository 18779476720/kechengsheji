<!DOCTYPE html>
<!--[if lt IE 7]>

<html class="lt-ie9 lt-ie8 lt-ie7" lang="en">

<![endif]-->
<!--[if IE 7]>

<html class="lt-ie9 lt-ie8" lang="en">

<![endif]-->
<!--[if IE 8]>

<html class="lt-ie9" lang="en">

<![endif]-->
<!--[if gt IE 8]>
<!-->

<html lang="en">

<!--
<![endif]-->
<head>
    <meta charset="utf-8">
    <title>
        学生首页
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- bootstrap css -->
    <script type="text/javascript" src="../../static/js/jquery.min.js"></script>

    <script type="text/javascript" src="../../static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="../../static/js/pagination.min.js"></script>
    <script type="text/javascript" src="../../static/js/toastr.min.js"></script>

    <link href="../../static/css/jqueryui.css" rel="stylesheet" type="text/css" />
    <!--<link href="../../static/js/bootstrap-3.3.7-dist/css/bootstrap.css" rel="stylesheet" type="text/css" />-->
    <link href="../../static/css/pagination.css" rel="stylesheet">
    <link href="../../static/icomoon/style.css" rel="stylesheet">
    <link href="../../static/css/toastr.css" rel="stylesheet" type="text/css"/>

    <!--[if lte IE 7]>
    <script src="../../static/css/icomoon-font/lte-ie7.js">
    </script>
    <![endif]-->
    <link href="../../static/css/wysiwyg/bootstrap-wysihtml5.css" rel="stylesheet">
    <link href="../../static/css/wysiwyg/wysiwyg-color.css" rel="stylesheet">
    <link href="../../static/css/main.css" rel="stylesheet"> <!-- Important. For Theming change primary-color variable in main.css  -->
    <link href="../../static/css/charts-graphs.css" rel="stylesheet">
</head>
<body style="background-image: url(../../static/images/jloginbg04.jpg);">
<header style="background-image: url(../../static/images/jloginbg04.jpg);background-size:10000px 10000px">
    <a href="#" class="logo">
        <img src="../../static/images/jlogosmall.png" width="70" height="90" alt="logo"/>
        <span class="mini-title" style="display: inline-block;"><a id="mailbox" style="font-size:30px; line-height:70px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;欢迎登陆大学生兼职网</a></span>
    </a>
    <div class="btn-group" id = "welcomeLogin"></div>
    <script type="text/javascript" src="../../static/myJs/welcomeLogin.js"></script>

</header>
<div class="container-fluid">
    <div class="dashboard-container" id="navigation">
    </div>
    <div class="dashboard-wrapper">

        <div class="left-sidebar">
            <div class="row-fluid">
                <div class="span12">
                    <div class="widget">
                        <div class="widget-header">
                            <div class="title pull-left">
                                找兼职</div>
                            <div class="pull-left" style="display: inline-block; vertical-align: middle;">
                                <div class="row">
                                    <div class="table-responsive">
                                        <div id="toolbar" style="padding-left: 50px">
                                            <!--<form class="form-inline">-->
                                                <!--<div class="form-group">-->
                                                    <!--&lt;!&ndash;<label for="searchJonType" class="col-sm-3 control-label" style="display: inline-block;font-size:15px">&nbsp;&nbsp;&nbsp;兼职类型：</label>&ndash;&gt;-->
                                                    <!--<div class="col-sm-6" style="display: inline-block">-->
                                                        <!--<input type="text" class="input-medium search-query" name="searchJonType" id="searchJonType"-->
                                                               <!--placeholder="请输入兼职岗位：">&nbsp;&nbsp;&nbsp;-->
                                                        <!--<button type="button" class="btn" onclick="loadData(0,10)"><span class="glyphicon glyphicon-zoom-out" style="color: rgb(36, 218, 255); font-size: 13px;"> 查询</span></button>-->
                                                    <!--</div>-->
                                                <!--</div>-->
                                            <!--</form>-->
                                        </div>
                                        <table id="table" ></table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="widget-body">
                            <div class="mail">
                                <table class="table table-striped table-hover table-condensed" contenteditable="true">
                                    <!--<table class="table table-condensed table-striped table-hover no-margin">-->
                                    <thead>
                                    <tr></tr>
                                    </thead>
                                    <!--兼职信息-->
                                    <tbody id = "counpBody" style="cursor: pointer;">
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row-fluid">
                <div class="span6">
                </div>
            </div>
            <div class="row-fluid">
            </div>
        </div>
        <!--<div class="right-sidebar">-->
            <!--<div class="wrapper">-->
            <!--</div>-->
            <!--<div class="wrapper">-->
                <!--<div id="scrollbar">-->
                    <!--<div class="scrollbar">-->
                        <!--<div class="track">-->
                            <!--<div class="thumb">-->
                                <!--<div class="end">-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->
                    <!--</div>-->
                    <!--<div class="viewport" style="height: 470px;">-->
                        <!--<div class="overview">-->
                            <!--<div class="featured-articles-container">-->
                                <!--<h5 class="heading" onclick="announcementsList()">-->
                                    <!--公告信息-->
                                <!--</h5>-->
                                <!--<div class="articles" style="height: 500px" id="articles">-->
                                <!--</div>-->
                            <!--</div>-->
                        <!--</div>-->
                    <!--</div>-->
                <!--</div>-->
            <!--</div>-->
        <!--</div>-->
    </div>
</div>
</div>
</div>
<!--点击某条公告弹框-->
<!--<div id="couponList" style="display: none"></div>-->
<!--点击企业弹框-->
<div id="bussinessDetailList" style="display: none"></div>

<!--投递弹框-->
<div id="deliveryDetailList" style="display: none"></div>

<!--<script type="text/javascript" src="../../static/myJs/announcementDialog.js"></script>-->
<script type="text/javascript" src="../../static/myJs/bussinessDetail.js"></script>
<script type="text/javascript" src="../../static/myJs/deliveryDialog.js"></script>
<script type="text/javascript">
    //加载导航栏
    $("#navigation").load("jump?html_url=navigation/studentNavigation");
    //加载欢迎框
    $("#welcomeLogin").load("jump?html_url=index/welcomeLogin");
    //加载公告框
    // $("#couponList").load("jump?html_url=dialog/announcementDialog");
    //加载企业信息弹框
    $("#bussinessDetailList").load("jump?html_url=dialog/bussinessDetail");
    //加载投递弹框
    $("#deliveryDetailList").load("jump?html_url=dialog/deliveryDialog");
    $(function(){
        loadData(0, 10, 0);
        welcomeLogin();
        // loadAnnouncement();
    });


    function loadData(currPage, pageSize, flag) {
        var pageNum = 0;
        if(flag == 0){
            pageNum = 0;
            pageSize = 5;
        }else {
            pageSize = 5;
            pageNum = currPage;
        }
        //处理数据
        $.ajax({
            type: "GET",
            contentType: 'application/json',
            dataType: "json",
            url: "http://localhost:8088/recommend/getRecommend",
            success: function (data){
                debugger
                if(data.datas.length > 0) {
                    $("#counpBody").html("");
                    for (var i = 0; i < data.datas.length; i++) {//默认显示第一页10个记录
                        var id = data.datas[i].id == null ? "" : data.datas[i].id;
                        var recruitType = data.datas[i].recruitType == null ? "" : data.datas[i].recruitType;
                        var recruitType1 = data.datas[i].recruitType1 == null ? "" : data.datas[i].recruitType1;
                        if(recruitType == '不限')
                            recruitType1 = '不限';
                        var recruitName = data.datas[i].recruitName == null ? "" : data.datas[i].recruitName;
                        var salaryDescription = data.datas[i].salaryDescription == null ? "" : data.datas[i].salaryDescription;
                        var createDate = data.datas[i].createDate == null ? "" : formatTime(data.datas[i].createDate);
                        var businessName = data.datas[i].businessName == null ? "" : data.datas[i].businessName;
                        var businessId = data.datas[i].businessId == null ? "" : data.datas[i].businessId;
                        var classStyle = (i + 1) % 4;
                        var classValue = '';
                        if(classStyle == 0){
                            var status = '';
                            status = 'error';
                            classValue = status;
                        }else if(classStyle == 1){
                            var status = '';
                            status = 'warning';
                            classValue = status;
                        }else if(classStyle == 2){
                            var status = '';
                            status = 'info';
                            classValue = status;
                        }else if(classStyle == 3){
                            var status = '';
                            status = 'success';
                            classValue = status;
                        }
                        var html = $("#counpBody").html();
                        html = '<tr class = "@classValue">'+
                            '<td style="display:none">@id</td><td>&nbsp;</td><td><p><strong style="color: rgb(36, 218, 255); font-size: 20px;" onclick="lookInfo(@id)">@recruitName</strong></p>'+
                            '<p>&nbsp;</p><p style="font-size: 15px;">@recruitType1</p></td><td><p><strong style="font-size: 18px;color: rgb(255, 96, 60);" onclick="businessDetailInfo(@businessId)">@businessName</strong></p>'+
                            '<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</p>'+
                            '<p style="font-size:13px;">@createDate</p></td><td><p>&nbsp;</p><p>&nbsp; &nbsp; &nbsp; &nbsp;<button type="button" class="btn" onclick="deliverJob(@id)">投递</button> </p>'+
                            '</td></tr>';
                        html = html.replace(/@classValue/g, classValue);
                        html = html.replace(/@id/g, id);
                        html = html.replace(/@recruitName/g, recruitName);
                        html = html.replace(/@recruitType1/g, recruitType1);
                        html = html.replace(/@businessId/g, businessId);
                        html = html.replace(/@salaryDescription/g, salaryDescription);
                        html = html.replace(/@createDate/g, createDate);
                        html = html.replace(/@businessName/g, businessName);
                        $("#counpBody").append(html);
                    }
                }else{
                    $("#counpBody").html("");
                    var html = "<h5 style='text-align: center'>没有更多数据推荐了！</h5>";
                    $("#counpBody").append(html);
                }
            },
        });
    }

    //进入公告信息页面
    function announcementsList(){
        window.location.href="/public/util/jump?html_url=announcements/announcementsList";
    }

    // 加载公告信息
    function loadAnnouncement(){
        //处理数据
        $.ajax({
            type: "GET",
            contentType: 'application/json',
            dataType: "json",
            url: "http://localhost:8088/announcementinfo/getall?flag=true&pageNum=0&pageSize=15",
            success: function (data){
                debugger
                if(data.list.length > 0) {
                    $("#articles").html("");
                    for (var i = 0; i < data.list.length; i++) {//默认显示第一页10个记录
                        var id = data.list[i].id == null ? "" : data.list[i].id;
                        var announcementName = data.list[i].announcementName == null ? "" : data.list[i].announcementName;
                        var html = $("#articles").html();
                        html = '<a onclick="announceInfoClick(@id)">'+
                            '<span class="label-bullet">&nbsp;</span>@announcementName'+
                            '</a>'
                        html = html.replace(/@id/g, id);
                        html = html.replace(/@announcementName/g, announcementName);
                        $("#articles").append(html);
                    }
                }else{
                    $("#articles").html("");
                    var html = "<h5 style='text-align: center'>当前没有公告！</h5>";
                    $("#articles").append(html);
                }
            },
        });
    };

    //进入招聘信息详情页
    function lookInfo(id) {
        window.location.href="/public/util/jump?html_url=index/recruitDetailInfo&id=" +id + "&flag=true";
    };



    //格式化日期

    function formatTime(date){
        var millis = new Date().getTime();
        var date1 = new Date(date);
        return date1.getFullYear() + '.' +
            ( ( date1.getMonth() + 1 ) < 10 ? '0' + ( date1.getMonth() + 1 ) : ( date1.getMonth() + 1 ) ) + '.' +
            ( date1.getDate() < 10 ? '0' + date1.getDate() : date1.getDate() );
    }


</script>
</body>
<script type="text/javascript" src="../../static/js/bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
</html>